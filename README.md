# Anomaly Prediction

Основные файлы:
1) `AnomalyGenerator.py` --- Файл с классом для генерации аномалий из файла или или из `pandas` датафремйма. Добавляет рандомно 3 вида аномалий к различным столбцам: 
* `Novelty` - у данных произошел "сдвиг". Прибавляет к данным с некоторого момента константу, основываясь на среднем значении ранее.
* `Collective` - коллективная аномалия. Так как в основном данные шумные, то если исчез шум, значит данная группа точек аномальна в датасете.
* `Individual` - Индивидуальная аномалия. Точка выбивается из общего ряда (высчитывается на основе ранее встречающихся значений).
* `Context` - TODO.

Пример работы класса можно посмотреть в [здесь](https://github.com/dimalunin2016/Anomaly/blob/master/Anomaly%20generator.ipynb).

2) `RobustRandomCutForest.py` --- baseline модель. Основана на алгоритме RobustRandomCutForest от компании "Амазон" ([Оригинальная статья](http://proceedings.mlr.press/v48/guha16.pdf), [сайт реализации](https://klabum.github.io/rrcf/)) и на Lazy Drifting Conformal Detector (LDCD) (Идея описана в [статье Евгения Бурнаева](https://arxiv.org/pdf/1706.03412.pdf)). Из плюсов: 
* Предсказания происходят онлайн
* Модель постоянно учится
* Алгоритм работает без меток данных.
* Адаптируется к динамическим изменениям в данных
* Работает с d-мерными объектами

Пример работы также приведен в ноутбуке выше.

3) `AnomalyModelABS.py` --- в нем расположен абстрактный класс `AnomalyModel`, от которого надо отнаследовать все новые модели для предсказания аномалий. Сейчас состоит только из одной функции - `predict_anomaly_proba` - предсказать вероятность аномалии для новой точки.
